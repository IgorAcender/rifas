{% extends 'base.html' %}
{% load static %}

{% block title %}Criar campanha | Sistema de Rifas{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-header-left">
        <svg class="header-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
        </svg>
        <h1>Criar campanha</h1>
    </div>
    <a href="{% url 'raffle_list' %}" class="btn-voltar">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Voltar
    </a>
</div>

<div class="form-container">
    <div class="form-steps">
        <div class="step active">
            <div class="step-number">1</div>
            <span>Informacoes</span>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <span>Imagens</span>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <span>Configuracoes</span>
        </div>
    </div>

    <form method="post" class="raffle-form" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-section active" data-step="1">
            <h2>Informacoes</h2>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="name">Nome da campanha</label>
                    <input
                        type="text"
                        id="name"
                        name="name"
                        placeholder="Informe o nome da sua campanha"
                        required
                    >
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="total_numbers">Quantidade de titulos</label>
                    <select id="total_numbers" name="total_numbers" required>
                        <option value="">Selecionar</option>
                        <option value="100">100 titulos</option>
                        <option value="200">200 titulos</option>
                        <option value="500">500 titulos</option>
                        <option value="1000">1.000 titulos</option>
                        <option value="2000">2.000 titulos</option>
                        <option value="5000">5.000 titulos</option>
                        <option value="10000">10.000 titulos</option>
                        <option value="20000">20.000 titulos - (00000 a 19999)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="price_per_number">Valor de cada titulo</label>
                    <div class="input-group">
                        <span class="input-prefix">R$</span>
                        <input
                            type="number"
                            id="price_per_number"
                            name="price_per_number"
                            step="0.01"
                            min="0.01"
                            placeholder="0,00"
                            required
                        >
                    </div>
                </div>
            </div>

            <div class="estimate-box">
                <p class="estimate-text">A sua arrecadacao estimada e de: <strong class="estimate-value">--</strong></p>
                <p class="tax-text">Taxa: <strong class="tax-value">--</strong></p>
                <a href="#" class="tax-link">Ver tabela de taxa →</a>
            </div>

            <button type="button" class="btn-primary btn-next" onclick="nextStep(2)">
                Criar e continuar →
            </button>
        </div>

        <div class="form-section" data-step="2">
            <h2>Imagens</h2>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="prize_name">Nome do premio</label>
                    <input
                        type="text"
                        id="prize_name"
                        name="prize_name"
                        placeholder="Ex: iPhone 15 Pro Max"
                        required
                    >
                </div>
            </div>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="prize_description">Descricao do premio</label>
                    <textarea
                        id="prize_description"
                        name="prize_description"
                        rows="4"
                        placeholder="Descreva o premio que sera sorteado..."
                    ></textarea>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="prize_image">Imagem do premio</label>
                    <div class="file-upload-box">
                        <input type="file" id="prize_image" name="prize_image" accept="image/*" onchange="previewImage(this)">
                        <div class="upload-placeholder">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                <polyline points="21 15 16 10 5 21"></polyline>
                            </svg>
                            <p>Clique para fazer upload da imagem</p>
                            <span class="upload-hint">PNG, JPG ou JPEG (max. 5MB)</span>
                        </div>
                        <img class="image-preview" style="display: none;">
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="prevStep(1)">
                    ← Voltar
                </button>
                <button type="button" class="btn-primary btn-next" onclick="nextStep(3)">
                    Continuar →
                </button>
            </div>
        </div>

        <div class="form-section" data-step="3">
            <h2>Configuracoes</h2>

            <div class="form-row">
                <div class="form-group full-width">
                    <label for="description">Descricao da campanha</label>
                    <textarea
                        id="description"
                        name="description"
                        rows="4"
                        placeholder="Descreva sua campanha..."
                    ></textarea>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="draw_date">Data do sorteio</label>
                    <input
                        type="datetime-local"
                        id="draw_date"
                        name="draw_date"
                    >
                </div>

                <div class="form-group">
                    <label for="status">Status inicial</label>
                    <select id="status" name="status">
                        <option value="draft">Rascunho</option>
                        <option value="active">Ativa</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="inviter_bonus">Bonus do indicante</label>
                    <input
                        type="number"
                        id="inviter_bonus"
                        name="inviter_bonus"
                        value="2"
                        min="0"
                    >
                    <span class="field-hint">Numeros gratis para quem indica</span>
                </div>

                <div class="form-group">
                    <label for="invitee_bonus">Bonus do indicado</label>
                    <input
                        type="number"
                        id="invitee_bonus"
                        name="invitee_bonus"
                        value="1"
                        min="0"
                    >
                    <span class="field-hint">Numeros gratis para quem foi indicado</span>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="prevStep(2)">
                    ← Voltar
                </button>
                <button type="submit" class="btn-primary">
                    Criar campanha
                </button>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/raffle-form.js' %}"></script>
{% endblock %}
